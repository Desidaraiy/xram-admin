import{_ as B}from"./Cu6ajlfn.js";import{_ as C}from"./BY7VE8ZU.js";import{_ as T,a as M}from"./DJfxPBq4.js";import{_ as h,a as j}from"./DTQ49aZk.js";import{_ as E}from"./byDhHAzm.js";import{f as N,g as O,h as F,i as L,r as b,j as g,c as P,b as a,w as i,_ as R,o as q,a as s,t as z,k as G,m as H,l as I,n as c,v as p,q as k}from"./DSqohS_p.js";import{_ as J}from"./C2qxqNzf.js";import"./DYukAyPS.js";import"./BZ2oriIC.js";import"./C3z8ikX4.js";const K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q=s("span",{class:"flex justify-center text-center text-base"}," Приглашение будет отправлено на электронную почту ",-1),W={class:"flex items-center my-2"},X=s("span",null,"Администраторы",-1),Y={class:"flex items-center my-2"},Z=s("span",null,"Клиенты",-1),ee={class:"flex items-center my-2"},te=s("span",null,"Группы",-1),oe={class:"flex items-center my-2"},se=s("span",null,"Рассылка",-1),ae={class:"flex items-center my-2"},ne=s("span",null,"Реклама",-1),le={class:"flex flex-row justify-end items-center m-2"},xe={__name:"[id]",setup(ie){const l=N(),V=O(),w=F();L(async()=>{await l.setCurrentAdmin(V.params.id),await l.getCurrentAdminSections(),n.sectionsData=S(n.sectionsData,l.currentAdminSections),o.fio=l.currentAdmin.fio,o.email=l.currentAdmin.email,o.phone=l.currentAdmin.phone,o.password=l.currentAdmin.password});const o=b({fio:"",email:"",phone:"",password:""}),n=b({sectionsData:{stats:{id:2,value:!0},clients:{id:3,value:!1},mailing:{id:4,value:!1},admins:{id:1,value:!1},advertising:{id:5,value:!1},groups:{id:7,value:!1}}}),D=r=>Object.values(r).filter(e=>e.value).map(e=>e.id),S=(r,e)=>(e.forEach(m=>{for(const[d,u]of Object.entries(r))u.id===m&&(u.value=!0)}),r),_=g(!1),v=g(""),y=async()=>{if(o.name==""||o.email==""||o.password==""){_.value=!0,v.value="Заполните все обязательные поля";return}const r={token:l.userToken,id:l.currentAdmin.id,fio:o.fio,email:o.email,phone:o.phone,password:o.password,type:"operator",active:"1"},e=k+"edit-admin";$fetch(e,{method:"POST",body:r}).then(m=>{const d=m.message;d==="ok"?A().then(()=>{w.push("/admins")}):alert(d)})},A=async()=>{const r=D(n.sectionsData),e=k+"set-privilege",m={token:l.userToken,admin_id:l.currentAdmin.id,sections:r};console.log("setting priveleges: ",m),$fetch(e,{method:"POST",body:m}).then(d=>{d.message=="ok"})};return(r,e)=>{const m=B,d=C,u=T,f=M,x=j,U=E,$=R;return q(),P("div",null,[a(m,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),title:"Ошибка"},{default:i(()=>[s("p",null,z(v.value),1)]),_:1},8,["modelValue"]),a($,{name:"authenticated"},{default:i(()=>[a(J,null,{default:i(()=>[a(d,{icon:G(H),title:"Редактирование администратора",back:!0,main:""},null,8,["icon"]),s("div",K,[a(h,{title:"Информация",form:"",onSubmit:I(y,["prevent"])},{default:i(()=>[a(f,{label:"Имя",help:"Обязательно"},{default:i(()=>[a(u,{modelValue:o.fio,"onUpdate:modelValue":e[1]||(e[1]=t=>o.fio=t),name:"name",autocomplete:"name"},null,8,["modelValue"])]),_:1}),a(f,{label:"E-mail",help:"Обязательно"},{default:i(()=>[a(u,{modelValue:o.email,"onUpdate:modelValue":e[2]||(e[2]=t=>o.email=t),name:"email",autocomplete:"email"},null,8,["modelValue"])]),_:1}),a(f,{label:"Телефон",help:"Обязательно"},{default:i(()=>[a(u,{modelValue:o.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>o.phone=t),name:"phone",intonly:!0,autocomplete:"phone"},null,8,["modelValue"])]),_:1}),a(f,{label:"Пароль",help:"Обязательно"},{default:i(()=>[a(u,{modelValue:o.password,"onUpdate:modelValue":e[4]||(e[4]=t=>o.password=t),name:"password",type:"password",autocomplete:"password"},null,8,["modelValue"])]),_:1}),Q]),_:1},8,["onSubmit"]),a(h,{title:"Доступные разделы"},{default:i(()=>[s("div",W,[c(s("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[5]||(e[5]=t=>n.sectionsData.admins.value=t)},null,512),[[p,n.sectionsData.admins.value]]),X]),s("div",Y,[c(s("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[6]||(e[6]=t=>n.sectionsData.clients.value=t)},null,512),[[p,n.sectionsData.clients.value]]),Z]),s("div",ee,[c(s("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[7]||(e[7]=t=>n.sectionsData.groups.value=t)},null,512),[[p,n.sectionsData.groups.value]]),te]),s("div",oe,[c(s("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[8]||(e[8]=t=>n.sectionsData.mailing.value=t)},null,512),[[p,n.sectionsData.mailing.value]]),se]),s("div",ae,[c(s("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[9]||(e[9]=t=>n.sectionsData.advertising.value=t)},null,512),[[p,n.sectionsData.advertising.value]]),ne])]),_:1})]),s("div",le,[a(U,null,{default:i(()=>[a(x,{color:"info",label:"Отмена",to:"/admins"}),a(x,{color:"success",label:"Сохранить",onClick:e[10]||(e[10]=t=>y())})]),_:1})])]),_:1})]),_:1})])}}};export{xe as default};
