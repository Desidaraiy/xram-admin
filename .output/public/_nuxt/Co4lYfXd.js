import{_ as W,a as J}from"./DJfxPBq4.js";import{a as C,_ as K}from"./DTQ49aZk.js";import{_ as L}from"./Cu6ajlfn.js";import{_ as X}from"./B8F8NKH2.js";import{_ as Y}from"./DYukAyPS.js";import{_ as z}from"./BHYj_u1D.js";import{y as H,f as E,z as _,j as d,o as n,c as i,b as a,w as c,a as e,F as G,A as U,t as V,k as A,Q as Z,B as N,C as D,d as R,i as ee,_ as te,E as I,q as le}from"./DSqohS_p.js";import{_ as Q}from"./T45vWLzi.js";import{_ as q}from"./byDhHAzm.js";import{_ as oe}from"./C2qxqNzf.js";import"./C3z8ikX4.js";import"./BZ2oriIC.js";const ae=e("p",null,"Действие необратимо",-1),ne=e("p",null,"Действие необратимо",-1),se={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800 flex flex-row justify-between items-center"},ue={class:"flex flex-row justify-start items-center overflow-x-auto"},re={class:"text-sm"},ie={class:"flex flex-col items-center justify-center p-1 text-slate-800 dark:text-slate-200"},de=e("thead",null,[e("tr",null,[e("th"),e("th",null,"Телефон"),e("th",null,"Удалить")])],-1),ce={"data-label":"Телефон"},me={"data-label":"Удалить"},_e={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},pe={__name:"TableGroupsClients",props:{checkable:Boolean},setup(T){const b=H(),s=E(),h=_(()=>s.currentGroupClients.length?s.currentGroupClients:[]),$=d(10),p=d(0),S=_(()=>h.value.slice($.value*p.value,$.value*(p.value+1))),m=_(()=>Math.ceil(h.value.length/$.value)),r=_(()=>p.value+1),F=_(()=>{const o=[];for(let l=0;l<m.value;l++)o.push(l);return o}),w=(o,l)=>{const t=[];return o.forEach(y=>{l(y)||t.push(y)}),t},B=(o,l)=>{o?v.value.push(l):v.value=w(v.value,t=>t.id===l.id)},v=d([]),x=d(!1),g=d(!1),P=d(0),M=_(()=>s.currentGroup),k=async()=>{await s.deleteClientFromGroup([P.value],M.value.id),x.value=!1,s.setCurrentGroup(s.currentGroup.id)},f=async()=>{const o=v.value.map(l=>l.id);await s.deleteClientFromGroup(o,M.value.id),g.value=!1,s.setCurrentGroup(s.currentGroup.id),v.value=[]};return(o,l)=>{const t=L,y=Y,O=z;return n(),i(G,null,[a(t,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=u=>x.value=u),title:"Подтвердите удаление пользователя из группы",button:"danger","has-cancel":"",onConfirm:l[1]||(l[1]=u=>k())},{default:c(()=>[ae]),_:1},8,["modelValue"]),a(t,{modelValue:g.value,"onUpdate:modelValue":l[2]||(l[2]=u=>g.value=u),title:"Подтвердите удаление пользователей из группы",button:"danger","has-cancel":"",onConfirm:l[3]||(l[3]=u=>f())},{default:c(()=>[ne]),_:1},8,["modelValue"]),v.value.length?(n(),i("div",se,[e("div",ue,[(n(!0),i(G,null,U(v.value,u=>(n(),i("div",{key:u.id,class:"flex flex-row justify-start items-center bg-gray-100 dark:bg-slate-700 px-2 py-1 rounded-sm mr-2"},[e("span",re,V(u.phone),1),e("div",ie,[a(y,{path:A(Z),size:"14",onClick:j=>B(!1,u)},null,8,["path","onClick"])])]))),128))]),a(C,{label:"Удалить из группы",color:"danger",small:"",onClick:l[4]||(l[4]=u=>g.value=!0)})])):N("",!0),e("table",null,[de,e("tbody",null,[(n(!0),i(G,null,U(S.value,u=>(n(),i("tr",{key:u.id},[a(O,{onChecked:j=>B(j,u)},null,8,["onChecked"]),e("td",ce,V(u.phone),1),e("td",me,[a(C,{color:"danger",label:"Удалить",onClick:j=>{x.value=!0,P.value=u.id}},null,8,["onClick"])])]))),128))])]),e("div",_e,[a(Q,null,{default:c(()=>[a(q,null,{default:c(()=>[(n(!0),i(G,null,U(F.value,u=>(n(),D(C,{key:u,active:u===p.value,label:u+1,small:"",outline:A(b).darkMode,onClick:j=>p.value=u},null,8,["active","label","outline","onClick"]))),128))]),_:1}),e("small",null,"Страница "+V(r.value)+" из "+V(m.value),1)]),_:1})])],64)}}},ve=e("p",null,"Данное действие нельзя отменить",-1),fe=e("p",null,[R("Lorem ipsum dolor sit amet "),e("b",null,"adipiscing elit")],-1),he=e("p",null,"This is sample modal",-1),ge={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800"},be={key:0},ke=e("th",null,"Название",-1),ye=e("th",null,"Рассылка",-1),Ce=e("th",null,"Объявление",-1),$e=e("th",null,"Редактировать",-1),xe=e("th",null,"Удалить",-1),Ge={"data-label":"Имя"},Ve={"data-label":"Рассылка"},Se={"data-label":"Объявление"},Be={"data-label":"Редактировать"},Me={"data-label":"Удалить"},we={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Pe={__name:"TableSampleGroups",props:{checkable:Boolean},setup(T){const b=H(),s=E(),h=_(()=>s.isSearchingGroups?s.groupsFound:s.groups);d(!1);const $=d(!1);d(!1);const p=d(!1),S=d(10),m=d(0),r=d([]),F=_(()=>h.value.slice(S.value*m.value,S.value*(m.value+1))),w=_(()=>Math.ceil(h.value.length/S.value)),B=_(()=>m.value+1),v=_(()=>{const f=[];for(let o=0;o<w.value;o++)f.push(o);return f}),x=(f,o)=>{const l=[];return f.forEach(t=>{o(t)||l.push(t)}),l},g=d(!1),P=(f,o)=>{f?r.value.push(o):r.value=x(r.value,l=>l.id===o.id)},M=async f=>{s.setCurrentGroup(f)},k=async()=>{s.deleteCurrentGroup()};return(f,o)=>{const l=pe;return n(),i(G,null,[a(L,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=t=>p.value=t),title:"Подтвердите удаление группы",button:"danger","button-label":"Удалить","has-cancel":"",onConfirm:o[1]||(o[1]=t=>k())},{default:c(()=>[ve]),_:1},8,["modelValue"]),a(L,{modelValue:$.value,"onUpdate:modelValue":o[2]||(o[2]=t=>$.value=t),"large-title":"Please confirm",button:"danger","has-cancel":""},{default:c(()=>[fe,he]),_:1},8,["modelValue"]),a(L,{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=t=>g.value=t),title:"Пользователи",checkable:!0,"has-table":""},{default:c(()=>[a(l)]),_:1},8,["modelValue"]),r.value.length?(n(),i("div",ge,[(n(!0),i(G,null,U(r.value,t=>(n(),i("span",{key:t.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-slate-700"},V(t.name),1))),128))])):N("",!0),e("table",null,[e("thead",null,[e("tr",null,[T.checkable?(n(),i("th",be)):N("",!0),ke,ye,Ce,$e,xe])]),e("tbody",null,[(n(!0),i(G,null,U(F.value,t=>(n(),i("tr",{key:t.id},[T.checkable?(n(),D(z,{key:0,onChecked:y=>P(y,t)},null,8,["onChecked"])):N("",!0),e("td",Ge,V(t.name.length>0?t.name:"---"),1),e("td",Ve,[a(C,{color:"info",label:"Рассылка",to:"pushmailing?groupid="+t.id},null,8,["to"])]),e("td",Se,[a(C,{color:"success",label:"Объявление",to:"advertising/new?groupid="+t.id},null,8,["to"])]),e("td",Be,[a(C,{color:"warning",label:"Редактировать",onClick:y=>{M(t.id),g.value=!0}},null,8,["onClick"])]),e("td",Me,[a(C,{color:"danger",label:"Удалить",onClick:y=>{M(t.id),p.value=!0}},null,8,["onClick"])])]))),128))])]),e("div",we,[a(Q,null,{default:c(()=>[a(q,null,{default:c(()=>[(n(!0),i(G,null,U(v.value,t=>(n(),D(C,{key:t,active:t===m.value,label:t+1,small:"",outline:A(b).darkMode,onClick:y=>m.value=t},null,8,["active","label","outline","onClick"]))),128))]),_:1}),e("small",null,"Страница "+V(B.value)+" из "+V(w.value),1)]),_:1})])],64)}}},Ue={key:1,class:"flex flex-col h-192 items-center justify-center"},Ae=e("h2",{class:"text-xl text-gray-700 dark:text-gray-300 my-2"},"Группы не найдены",-1),Fe=[Ae],We={__name:"groups",setup(T){const b=E(),s=d(!1),h=d("");ee(()=>{b.getGroupsList()});const $=_(()=>b.groups.length===0),p=async()=>{const m=le+"group";await $fetch(m,{method:"POST",body:{token:b.userToken,group_name:h.value,action:"add",group_state:1}}).then(r=>{r.message==="ok"?(s.value=!1,h.value="",b.getGroupsList()):alert("Ошибка: ",r.message)})},S=m=>{b.setSearchingGroupsQuery(m)};return(m,r)=>{const F=W,w=J,B=C,v=L,x=X,g=Pe,P=K,M=te;return n(),i("div",null,[a(v,{modelValue:s.value,"onUpdate:modelValue":r[2]||(r[2]=k=>s.value=k),title:"Добавить группу"},{default:c(()=>[a(w,{label:"Название",help:"Название для группы"},{default:c(()=>[a(F,{modelValue:h.value,"onUpdate:modelValue":r[0]||(r[0]=k=>h.value=k),placeholder:"Название",type:"text"},null,8,["modelValue"])]),_:1}),a(B,{color:"info",label:"Создать группу",onClick:r[1]||(r[1]=k=>p())})]),_:1},8,["modelValue"]),a(M,{name:"authenticated"},{default:c(()=>[a(oe,null,{default:c(()=>[a(x,{icon:A(I),title:"Группы",main:""},{default:c(()=>[a(B,{color:"success",label:"Добавить",onClick:r[3]||(r[3]=k=>s.value=!0)})]),_:1},8,["icon"]),A($)?(n(),i("div",Ue,Fe)):(n(),D(P,{key:0,icon:A(I),title:"Группы клиентов","has-table":"","has-searchbar":"",onSearchString:S},{default:c(()=>[a(g)]),_:1},8,["icon"]))]),_:1})]),_:1})])}}};export{We as default};
