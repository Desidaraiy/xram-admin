import{_ as T}from"./Cu6ajlfn.js";import{_ as A}from"./BY7VE8ZU.js";import{_ as L,a as M}from"./DJfxPBq4.js";import{_ as V,a as j}from"./DTQ49aZk.js";import{_ as E}from"./byDhHAzm.js";import{h as P,f as F,r as y,j as x,c as N,b as s,w as n,_ as O,o as z,a as o,t as Z,k as q,m as R,l as G,n as p,v as c,q as w}from"./DSqohS_p.js";import{_ as H}from"./C2qxqNzf.js";import"./DYukAyPS.js";import"./BZ2oriIC.js";import"./C3z8ikX4.js";const I={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J=o("span",{class:"flex justify-center text-center text-base"}," Приглашение будет отправлено на электронную почту ",-1),K={class:"flex items-center my-2"},Q=o("span",null,"Администраторы",-1),W={class:"flex items-center my-2"},X=o("span",null,"Чаты",-1),Y={class:"flex items-center my-2"},ee=o("span",null,"Клиенты",-1),te={class:"flex items-center my-2"},oe=o("span",null,"Группы",-1),se={class:"flex items-center my-2"},ae=o("span",null,"Рассылка",-1),le={class:"flex items-center my-2"},ne=o("span",null,"Реклама",-1),re={class:"flex flex-row justify-end items-center m-2"},he={__name:"new",setup(ie){const k=P(),h=F(),a=y({fio:"",email:"",phone:"",password:""}),v=y({password:""}),l=y({sectionsData:{stats:{id:2,value:!0},clients:{id:3,value:!1},mailing:{id:4,value:!1},admins:{id:1,value:!1},advertising:{id:5,value:!1},chats:{id:6,value:!1},groups:{id:7,value:!1}}}),D=r=>Object.values(r).filter(e=>e.value).map(e=>e.id);x(0);const u=x(!1),f=x("");function U(r){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(r).toLowerCase())}function $(r){return/^(\+7|7|8)?[\s\-]?\(?[489][0-9]{2}\)?[\s\-]?[0-9]{3}[\s\-]?[0-9]{2}[\s\-]?[0-9]{2}$/.test(String(r).toLowerCase())}const b=()=>{if(a.name==""||a.email==""||a.password==""){u.value=!0,f.value="Заполните все обязательные поля";return}if(a.password!=v.password){u.value=!0,f.value="Пароли не совпадают";return}if(!U(a.email)){u.value=!0,f.value="Некорректный email";return}if(!$(a.phone)){u.value=!0,f.value="Некорректный телефон";return}const r={token:h.userToken,fio:a.fio,email:a.email,phone:a.phone,password:a.password,type:"operator",active:"1"},e=w+"add-admin";$fetch(e,{method:"POST",body:r}).then(m=>{m.message=="ok"&&S(m.admin[0].id).then(()=>{k.push("/admins")})})},S=async r=>{const e=D(l.sectionsData),m=w+"set-privilege",_={token:h.userToken,admin_id:r,sections:e};$fetch(m,{method:"POST",body:_}).then(i=>{i.message=="ok"})};return(r,e)=>{const m=T,_=A,i=L,d=M,g=j,B=E,C=O;return z(),N("div",null,[s(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),title:"Ошибка"},{default:n(()=>[o("p",null,Z(f.value),1)]),_:1},8,["modelValue"]),s(C,{name:"authenticated"},{default:n(()=>[s(H,null,{default:n(()=>[s(_,{icon:q(R),title:"Новый администратор",back:!0,main:""},null,8,["icon"]),o("div",I,[s(V,{title:"Информация",form:"",onSubmit:G(b,["prevent"])},{default:n(()=>[s(d,{label:"Имя",help:"Обязательно"},{default:n(()=>[s(i,{modelValue:a.fio,"onUpdate:modelValue":e[1]||(e[1]=t=>a.fio=t),name:"name",autocomplete:"name"},null,8,["modelValue"])]),_:1}),s(d,{label:"E-mail",help:"Обязательно"},{default:n(()=>[s(i,{modelValue:a.email,"onUpdate:modelValue":e[2]||(e[2]=t=>a.email=t),name:"email",autocomplete:"email"},null,8,["modelValue"])]),_:1}),s(d,{label:"Телефон",help:"Обязательно"},{default:n(()=>[s(i,{modelValue:a.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>a.phone=t),name:"phone",autocomplete:"phone"},null,8,["modelValue"])]),_:1}),s(d,{label:"Пароль",help:"Обязательно"},{default:n(()=>[s(i,{modelValue:a.password,"onUpdate:modelValue":e[4]||(e[4]=t=>a.password=t),name:"password",type:"password",autocomplete:"password"},null,8,["modelValue"])]),_:1}),s(d,{label:"Повторите пароль",help:"Обязательно"},{default:n(()=>[s(i,{modelValue:v.password,"onUpdate:modelValue":e[5]||(e[5]=t=>v.password=t),name:"password",type:"password",autocomplete:"password"},null,8,["modelValue"])]),_:1}),J]),_:1},8,["onSubmit"]),s(V,{title:"Доступные разделы"},{default:n(()=>[o("div",K,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[6]||(e[6]=t=>l.sectionsData.admins.value=t)},null,512),[[c,l.sectionsData.admins.value]]),Q]),o("div",W,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[7]||(e[7]=t=>l.sectionsData.chats.value=t)},null,512),[[c,l.sectionsData.chats.value]]),X]),o("div",Y,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[8]||(e[8]=t=>l.sectionsData.clients.value=t)},null,512),[[c,l.sectionsData.clients.value]]),ee]),o("div",te,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[9]||(e[9]=t=>l.sectionsData.groups.value=t)},null,512),[[c,l.sectionsData.groups.value]]),oe]),o("div",se,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[10]||(e[10]=t=>l.sectionsData.mailing.value=t)},null,512),[[c,l.sectionsData.mailing.value]]),ae]),o("div",le,[p(o("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[11]||(e[11]=t=>l.sectionsData.advertising.value=t)},null,512),[[c,l.sectionsData.advertising.value]]),ne])]),_:1})]),o("div",re,[s(B,null,{default:n(()=>[s(g,{color:"info",label:"Отмена",to:"/admins"}),s(g,{color:"success",label:"Сохранить",onClick:e[12]||(e[12]=t=>b())})]),_:1})])]),_:1})]),_:1})])}}};export{he as default};
