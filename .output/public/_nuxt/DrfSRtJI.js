import{_ as k}from"./Cu6ajlfn.js";import{r as x,s as y,j as n,f as $,a8 as B,G as S,c as C,b as a,w as l,x as N,_ as D,o as M,a as U,t as A,J as I,k as _,a9 as P,l as E,aa as L,ab as O,q as R}from"./DSqohS_p.js";import{_ as T}from"./BuysOuIl.js";import{_ as j,a as q}from"./DTQ49aZk.js";import{a as h,_ as b}from"./DJfxPBq4.js";import{_ as z}from"./byDhHAzm.js";import"./DYukAyPS.js";import"./BZ2oriIC.js";import"./C3z8ikX4.js";const ee={__name:"login",setup(G){const s=x({phone:"",password:""}),V=y(N,{sameSite:"None",secure:!0}),i=n("Проверьте телефон и пароль");$();const w=B(),r=n(!1),u=n(!1),d=n(!0),m=n(!0),f={phone:o=>o.length===11,password:o=>o.length>=1};S(s,(o,e)=>{d.value=f.phone(o.phone),m.value=f.password(o.password)},{deep:!0});const g=async()=>{if(s.phone==""||s.password==""){u.value=!0,i.value="Заполните все обязательные поля";return}r.value=!0;const o=R+"login";await $fetch(o,{method:"POST",body:s}).then(e=>{const p=e.message;if(r.value=!1,p==="ok"){const{message:v,token:t}=e;V.value=t,w.push("/")}else u.value=!0,i.value="Проверьте телефон и пароль"})};return(o,e)=>{const p=k,v=D;return M(),C("div",null,[a(p,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),title:"Ошибка входа",buttonLabel:"OK"},{default:l(()=>[U("p",null,A(i.value),1)]),_:1},8,["modelValue"]),a(v,null,{default:l(()=>[a(T,{bg:"greenIndigo"},{default:l(({cardClass:t})=>[a(j,{class:I([t,"max-h-screen overflow-y-auto"]),form:"",title:"«Телеос-1» кабинет администратора",headerIcon:_(P),onSubmit:E(g,["prevent"])},{footer:l(()=>[a(z,null,{default:l(()=>[a(q,{type:"submit",color:"success",small:"",disabled:r.value,label:r.value?"Загрузка...":"Войти"},null,8,["disabled","label"])]),_:1})]),default:l(()=>[a(h,{label:"Телефон",help:d.value?"Телефон для входа":"Телефон должен содержать 11 цифр",isValid:d.value},{default:l(()=>[a(b,{modelValue:s.phone,"onUpdate:modelValue":e[1]||(e[1]=c=>s.phone=c),icon:_(L),type:"tel",name:"login",autocomplete:"phone"},null,8,["modelValue","icon"])]),_:1},8,["help","isValid"]),a(h,{label:"Пароль",help:m.value?"Пароль для входа":"Пароль не может быть пустым",isValid:m.value},{default:l(()=>[a(b,{modelValue:s.password,"onUpdate:modelValue":e[2]||(e[2]=c=>s.password=c),icon:_(O),type:"password",name:"password",autocomplete:"current-password"},null,8,["modelValue","icon"])]),_:1},8,["help","isValid"])]),_:2},1032,["class","headerIcon","onSubmit"])]),_:1})]),_:1})])}}};export{ee as default};
