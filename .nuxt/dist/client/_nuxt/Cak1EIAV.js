import{_ as O}from"./BY7VE8ZU.js";import{_ as P}from"./sfjfEMc_.js";import{a as R,_ as q}from"./DJfxPBq4.js";import{_ as E,a as z}from"./DTQ49aZk.js";import{_ as A}from"./DYukAyPS.js";import{g as H,h as J,f as K,j as d,r as Q,i as W,G as m,c as h,b as l,w as r,q as C,_ as X,o as p,k as b,m as Y,a,C as U,n as Z,v as ee,B as k,ad as I,t as w}from"./DSqohS_p.js";import{_ as te}from"./C2qxqNzf.js";import"./C3z8ikX4.js";const ae={class:"grid grid-cols-3 gap-6"},se={class:"col-span-2"},le={key:1},oe={class:"flex items-center my-8"},ne=a("span",null,"Отправить сейчас",-1),de={class:"flex flex-row justify-center items-center w-full"},ie={class:"w-80 h-160 border-4 border-slate-800 dark:border-slate-500 rounded-3xl flex flex-col items-center justify-center px-2"},ue={class:"flex flex-col mx-4 rounded-lg dark:bg-slate-400 bg-slate-300 drop-shadow-md w-full"},re={class:"flex flex-row justify-between w-full rounded-t-lg px-2 py-1/2 dark:bg-slate-500"},ce={class:"flex flex-row"},me=a("span",{class:"font-light text-lg ml-2"},"Телеос-1",-1),pe=a("span",{class:"font-light text-display"},"сейчас",-1),_e={class:"w-full flex flex-col px-2 py-2"},fe={key:0,class:"font-bold text-display mb-1"},ve={key:1,class:"font-medium text-display my-1"},ge={class:"font-light text-display mt-1 text-ellipsis line-clamp-2"},Be={__name:"[id]",setup(he){const V=H(),N=J(),S=K(),$=d([]);function B(o){return o===!0?1:0}const c=d("Введите текст"),i=d(""),x=d(""),j=new Date().toISOString(),T=d(!1),t=Q({title:i.value,subtitle:x.value,message:c.value,groups_id:[],to_all:0,users_id:[],token:S.userToken,date:j,now:1,date:"",id:0}),u=d(!0),_=d(""),f=d([]);W(()=>{D(V.params.id),t.id=V.params.id});const D=async o=>{const e=C+"show-message";await $fetch(e,{method:"POST",body:{token:S.userToken,message_id:o}}).then(s=>{if(c.value=s.data.message.message,i.value=s.data.message.title,_.value=s.data.message.date,u.value=s.data.message.date.split("-")[0]=="0000",s.data.all[0].to_all!=1)for(let v=0;v<s.data.groups.length;v++)$.value.push(s.data.groups[v].id);T.value=!0})};m(f,()=>{t.to_all=B(f.value.length===0),t.groups_id=f.value}),m(t.value,()=>{console.log(t.date)}),m(u,()=>{t.now=B(u.value),u.value&&(t.date="")}),m(_,()=>{t.date=_.value}),m(i,o=>{t.title=o}),m(c,o=>{t.message=o});const G=async()=>{if(t.message.length==0){alert("Введите текст");return}if(t.now==0&&t.date==""){alert("Выберите дату рассылки или нажмите «Отправить сейчас»");return}const o=C+"edit-message";await $fetch(o,{method:"POST",body:t}).then(e=>{const s=e.message;s==="ok"?N.back():alert(s)})};return(o,e)=>{const s=O,v=P,g=R,y=q,L=z,M=A,F=X;return p(),h("div",null,[l(F,{name:"authenticated"},{default:r(()=>[l(te,null,{default:r(()=>[l(s,{icon:b(Y),title:"Редактировать уведомление",back:!0,main:""},null,8,["icon"]),a("div",ae,[a("div",se,[l(E,{form:""},{default:r(()=>[l(g,{label:"Группы",help:"Выберите группы для рассылки"},{default:r(()=>[T.value?(p(),U(v,{key:0,modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=n=>f.value=n),"pre-selected-groups":$.value},null,8,["modelValue","pre-selected-groups"])):(p(),h("div",le,"Загрузка групп..."))]),_:1}),l(g,{label:"Заголовок (необязательно)",help:"Заголовок уведомления"},{default:r(()=>[l(y,{name:"title",modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=n=>i.value=n)},null,8,["modelValue"])]),_:1}),l(g,{label:"Сообщение",help:"Введите сообщение"},{default:r(()=>[l(y,{type:"textarea",name:"message",modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value=n)},null,8,["modelValue"])]),_:1}),a("div",oe,[Z(a("input",{type:"checkbox",class:"form-checkbox rounded-full text-primary-500 border-primary-500 focus:ring-primary-500 mr-4 p-3","onUpdate:modelValue":e[3]||(e[3]=n=>u.value=n)},null,512),[[ee,u.value]]),ne]),u.value?k("",!0):(p(),U(g,{key:0,label:"Дата и время",help:"В эту дату и время начнется рассылка"},{default:r(()=>[l(y,{type:"datetime-local",name:"date",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=n=>_.value=n)},null,8,["modelValue"])]),_:1})),a("div",de,[l(L,{color:"info",label:"Отправить",onClick:e[5]||(e[5]=n=>G()),icon:b(I)},null,8,["icon"])])]),_:1})]),a("div",ie,[a("div",ue,[a("div",re,[a("div",ce,[l(M,{path:b(I)},null,8,["path"]),me]),pe]),a("div",_e,[i.value!==""?(p(),h("span",fe,w(i.value),1)):k("",!0),x.value!==""?(p(),h("span",ve,w(x.value),1)):k("",!0),a("span",ge,w(c.value),1)])])])])]),_:1})]),_:1})])}}};export{Be as default};
