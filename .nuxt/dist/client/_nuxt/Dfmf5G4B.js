import{_ as T}from"./BY7VE8ZU.js";import{_ as U}from"./sfjfEMc_.js";import{a as L,_ as C}from"./DJfxPBq4.js";import{_ as A,a as G}from"./DTQ49aZk.js";import{_ as F}from"./byDhHAzm.js";import{g as I,h as N,j as c,f as O,r as P,i as j,G as M,c as k,b as a,w as s,q as m,_ as R,o as f,k as b,m as q,a as h,C as E}from"./DSqohS_p.js";import{_ as z}from"./C2qxqNzf.js";import"./DYukAyPS.js";import"./C3z8ikX4.js";const D={class:"grid grid-cols-1 w-full gap-4"},H={key:1},J={class:"flex flex-row justify-start items-center m-2"},le={__name:"[id]",setup(K){const p=I(),v=N(),g=c([]),r=O(),u=c([]),y=c(!1),e=P({action_url:"",token:r.userToken,text:"",title:"",date_start:"",date_end:"",to_all:!0,groups_id:[],advertising_id:parseInt(p.params.id)});j(()=>{x(p.params.id)}),M(u,()=>{e.to_all=u.value.length===0,e.groups_id=u.value});const x=async d=>{const t=m+"get-advertising-by-id";await $fetch(t,{method:"POST",body:{token:r.userToken,advertising_id:d}}).then(o=>{if(o.message!="ok"){alert("Ошибка"),v.back(),r.getAdvertsList();return}if(e.action_url=o.advertise[0].action_url,e.token=r.userToken,e.text=o.advertise[0].text,e.title=o.advertise[0].title,e.date_start=o.advertise[0].date_start.split(" ")[0],e.date_end=o.advertise[0].date_end.split(" ")[0],o.advertise[0].to_all!=1)for(let n=0;n<o.advertise.length;n++)g.value.push(o.advertise[n].group_id);y.value=!0})},$=async()=>{const d=m+"edit-advertising";$fetch(d,{method:"POST",body:e}).then(async t=>{t.message==="ok"?(await B(e.advertising_id),v.back(),r.getAdvertsList()):alert("Ошибка: ",t.picture)})},B=async d=>{let t;const o={token:e.token,advertising_id:d};e.to_all?(o.to_all=1,o.users_id=[],t=m+"advertising-to-users"):(o.to_all=0,o.groups_id=e.groups_id,t=m+"advertising-to-groups"),await $fetch(t,{method:"POST",body:o}).then(n=>{console.log(n)})};return(d,t)=>{const o=T,n=U,i=L,_=C,V=G,w=F,S=R;return f(),k("div",null,[a(S,{name:"authenticated"},{default:s(()=>[a(z,null,{default:s(()=>[a(o,{icon:b(q),title:"Редактировать объявление / "+b(p).params.id,back:!0,main:""},null,8,["icon","title"]),h("div",D,[a(A,{title:"Информация",form:""},{default:s(()=>[a(i,{label:"Группы"},{default:s(()=>[y.value?(f(),E(n,{key:0,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),"pre-selected-groups":g.value},null,8,["modelValue","pre-selected-groups"])):(f(),k("div",H,"Загрузка групп..."))]),_:1}),a(i,{label:"Текст для предварительного просмотра (10-25 символов)"},{default:s(()=>[a(_,{modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=l=>e.title=l),placeholder:"Текст",type:"text"},null,8,["modelValue"])]),_:1}),a(i,{label:"Текст для кнопки перехода (10-25 символов)"},{default:s(()=>[a(_,{modelValue:e.text,"onUpdate:modelValue":t[2]||(t[2]=l=>e.text=l),placeholder:"Текст",type:"text"},null,8,["modelValue"])]),_:1}),a(i,{label:"Ссылка для перехода"},{default:s(()=>[a(_,{modelValue:e.action_url,"onUpdate:modelValue":t[3]||(t[3]=l=>e.action_url=l),placeholder:"https://...",type:"text"},null,8,["modelValue"])]),_:1}),a(i,{label:"Дата, с которой будет видно объявление"},{default:s(()=>[a(_,{modelValue:e.date_start,"onUpdate:modelValue":t[4]||(t[4]=l=>e.date_start=l),placeholder:"Дата",type:"date"},null,8,["modelValue"])]),_:1}),a(i,{label:"Дата, в которую объявление будет скрыто"},{default:s(()=>[a(_,{modelValue:e.date_end,"onUpdate:modelValue":t[5]||(t[5]=l=>e.date_end=l),placeholder:"Дата",type:"date"},null,8,["modelValue"])]),_:1})]),_:1})]),h("div",J,[a(w,null,{default:s(()=>[a(V,{color:"info",label:"Отмена",to:"/advertising"}),a(V,{color:"success",label:"Готово",onClick:t[6]||(t[6]=l=>$())})]),_:1})])]),_:1})]),_:1})])}}};export{le as default};
