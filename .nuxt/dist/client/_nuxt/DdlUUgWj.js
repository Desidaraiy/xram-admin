import{_ as ce}from"./DYukAyPS.js";import{a as te,_ as me}from"./DJfxPBq4.js";import{G as X,y as ae,f as se,z as f,j as o,r as ve,o as u,c as i,a as t,b as a,w as n,n as ee,a5 as le,F as x,A as M,t as d,C as Y,k as z,s as fe,x as pe,a6 as _e,Q as he,B as W,q as O}from"./DSqohS_p.js";import{_ as oe}from"./T45vWLzi.js";import{_ as ne}from"./byDhHAzm.js";import{a as h}from"./DTQ49aZk.js";import{_ as y}from"./Cu6ajlfn.js";import{_ as be}from"./BHYj_u1D.js";const ge={class:"flex flex-row mx-auto py-4 justify-around items-start"},ke=t("span",{class:"flex flex-col items-center my-auto"},"Выберите даты",-1),ye={class:"flex flex-row mx-auto py-4 px justify-start items-start"},xe=t("thead",null,[t("tr",null,[t("th",null,"Сообщение"),t("th",null,"Дата"),t("th",null,"Объект")])],-1),Ve={"data-label":"Сообщение"},Ce={"data-label":"Дата"},$e={"data-label":"Объект"},we={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},Me={__name:"TableMessages",props:{checkable:Boolean,isActive:Boolean},emits:["reset-dates"],setup(U,{emit:$}){const E=U;X(()=>E.isActive,k=>{k&&(w(),p.isSearchingMessages=!1)});const b=$,D=ae(),p=se(),g=f(()=>p.isSearchingMessages?p.foundMessages:p.messages),m=o(30),V=o(0),A=f(()=>g.value.slice(m.value*V.value,m.value*(V.value+1))),T=f(()=>Math.ceil(g.value.length/m.value)),H=f(()=>V.value+1),q=f(()=>{const k=[];for(let _=0;_<T.value;_++)k.push(_);return k}),c=ve({startDate:"",endDate:""}),w=()=>{c.startDate="",c.endDate="",b("reset-dates")};return X(c,()=>{c.startDate!=""||c.endDate!=""?p.getMessagesList(c):p.isSearchingMessages=!1}),(k,_)=>{const j=te;return u(),i(x,null,[t("div",ge,[ke,a(j,{label:"Дата, От"},{default:n(()=>[ee(t("input",{type:"date","onUpdate:modelValue":_[0]||(_[0]=s=>c.startDate=s),class:"px-3 py-2 max-w-full focus:ring focus:outline-none border-gray-700 rounded w-full dark:placeholder-gray-400 h-12 border bg-white dark:bg-slate-800"},null,512),[[le,c.startDate]])]),_:1}),a(j,{label:"Дата, До"},{default:n(()=>[ee(t("input",{type:"date","onUpdate:modelValue":_[1]||(_[1]=s=>c.endDate=s),class:"px-3 py-2 max-w-full focus:ring focus:outline-none border-gray-700 rounded w-full dark:placeholder-gray-400 h-12 border bg-white dark:bg-slate-800"},null,512),[[le,c.endDate]])]),_:1})]),t("div",ye,[a(h,{label:"Сбросить период",color:"info",small:"",onClick:w})]),t("table",null,[xe,t("tbody",null,[(u(!0),i(x,null,M(A.value,s=>(u(),i("tr",{key:s.id},[t("td",Ve,d(s.message),1),t("td",Ce,d(s.date),1),t("td",$e,d(s.object!=null&&s.object.length!=0?s.object:"---"),1)]))),128))])]),t("div",we,[a(oe,null,{default:n(()=>[a(ne,null,{default:n(()=>[(u(!0),i(x,null,M(q.value,s=>(u(),Y(h,{key:s,active:s===V.value,label:s+1,small:"",outline:z(D).darkMode,onClick:Z=>V.value=s},null,8,["active","label","outline","onClick"]))),128))]),_:1}),t("small",null,"Страница "+d(H.value)+" из "+d(T.value),1)]),_:1})])],64)}}},Pe=t("h2",{class:"my-2"},"Операция завершена успешно",-1),Se=t("h2",{class:"my-2"},"Возникла ошибка, попробуйте позже.",-1),Ue={class:"flex flex-col"},De={class:"flex flex-col rounded-lg p-2 m-2 drop-shadow-lg bg-slate-200 dark:bg-slate-500"},Ae={class:"flex flex-row items-center"},Te={class:"flex flex-col"},je={class:"text-gray-500 dark:text-slate-800 font-bold m-1"},Be={class:"text-gray-500 dark:text-slate-800 font-bold m-1"},Fe={class:"flex flex-col"},Le={class:"text-gray-500 dark:text-slate-800 m-1"},Ge={class:"text-gray-500 dark:text-slate-800 m-1"},Ne={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800 flex flex-row justify-between items-center"},Ie={class:"flex flex-row justify-start items-center overflow-x-auto"},Oe={class:"text-sm"},ze={class:"flex flex-col items-center justify-center p-1 text-slate-800 dark:text-slate-200"},Ee={key:0},He=t("th",null,"Номер договора",-1),qe=t("th",null,"Адрес договора",-1),Qe=t("th",null,"Город",-1),Je=t("th",null,"Отправить уведомление",-1),Ke={class:"border-b-0 lg:w-6 before:hidden","data-label":"Договор"},We={class:"border-b-0 lg:w-6 before:hidden","data-label":"Адрес"},Xe={class:"border-b-0 lg:w-6 before:hidden","data-label":"Город"},Ye={"data-label":"Уведомление"},Ze={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},ul={__name:"TableSampleClients",props:{checkable:Boolean},setup(U){const $=fe(pe,{sameSite:"None",secure:!0}),E=ae(),b=se(),D=f(()=>b.isSearchingClients?b.clientsFound:b.clients),p=o(10),g=o(0),m=o([]),V=f(()=>D.value.slice(p.value*g.value,p.value*(g.value+1))),A=f(()=>Math.ceil(D.value.length/p.value)),T=f(()=>g.value+1),H=f(()=>{const r=[];for(let l=0;l<A.value;l++)r.push(l);return r}),q=(r,l)=>{const v=[];return r.forEach(C=>{l(C)||v.push(C)}),v},c=(r,l)=>{r?m.value.push(l):m.value=q(m.value,v=>v.id===l.id)},w=o(!1),k=o(!1),_=o([]),j=f(()=>b.groups),s=o(0),Z=async()=>{const r=O+"add-user-to-group",l=m.value.map(v=>v.id);await $fetch(r,{method:"POST",body:{group_id:s.value.value,user_id:l,token:$.value}}).then(v=>{v.message==="ok"&&(L.value=!1,m.value=[],b.getGroupsList())})},B=o(!1),P=o("Нажмите кнопку ниже");X(B,()=>{w.value==!1&&(P.value="Нажмите кнопку ниже")});const ue=async()=>{const r=O+"set-user-pin";await $fetch(r,{method:"POST",body:{user_id:R.value,password:P.value,token:$.value}}).then(l=>{l.message==="ok"&&(B.value=!1,P.value="")})},F=o(!1),Q=o(!1),J=o(!1),L=o(!1),G=o(""),S=o(""),R=o(0),de=async()=>{const r=O+"send-push";await $fetch(r,{method:"POST",body:{phone:S.value,text:G.value,token:$.value}}).then(l=>{G.value="",l.message==="ok"?(F.value=!1,Q.value=!0):J.value=!0})},K=o(!1),re=async()=>{const r=O+"update-user-phone";await $fetch(r,{method:"POST",body:{user_id:R.value,token:$.value,phone:S.value}}).then(l=>{l.message==="ok"&&b.getClientsList()})};return(r,l)=>{const v=ce,C=me,N=te,ie=Me;return u(),i(x,null,[a(y,{modelValue:Q.value,"onUpdate:modelValue":l[0]||(l[0]=e=>Q.value=e),title:"Операция завершена"},{default:n(()=>[Pe]),_:1},8,["modelValue"]),a(y,{modelValue:J.value,"onUpdate:modelValue":l[1]||(l[1]=e=>J.value=e),title:"Операция завершена"},{default:n(()=>[Se]),_:1},8,["modelValue"]),a(y,{modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value=e),title:"Устройства пользователя"},{default:n(()=>[t("div",Ue,[(u(!0),i(x,null,M(_.value,e=>(u(),i("div",De,[t("div",Ae,[a(v,{path:z(_e),size:50,h:"h-16",w:"w-16"},null,8,["path"]),t("div",Te,[t("p",je,d(e.phone_type),1),t("p",Be," ПО: "+d(e.phone_os)+", версия Сэйв.info: "+d(e.app_version),1)])]),t("div",Fe,[t("p",Le," Зарегистрирован "+d(e.register_date),1),t("p",Ge," Был в сети "+d(e.last_online),1)])]))),256))])]),_:1},8,["modelValue"]),a(y,{modelValue:B.value,"onUpdate:modelValue":l[5]||(l[5]=e=>B.value=e),title:"Сброс пин-кода пользователя"},{default:n(()=>[a(N,{label:"Новый пинкод"},{default:n(()=>[a(C,{modelValue:P.value,"onUpdate:modelValue":l[3]||(l[3]=e=>P.value=e),placeholder:"4 цифры",type:"number"},null,8,["modelValue"])]),_:1}),a(h,{color:"info",label:"Сменить пин-код",onClick:l[4]||(l[4]=e=>ue())})]),_:1},8,["modelValue"]),a(y,{modelValue:F.value,"onUpdate:modelValue":l[8]||(l[8]=e=>F.value=e),title:"Отправить сообщение пользователю"},{default:n(()=>[a(N,{label:"Сообщение",help:"Сообщение для пользователя"},{default:n(()=>[a(C,{modelValue:G.value,"onUpdate:modelValue":l[6]||(l[6]=e=>G.value=e),placeholder:"Сообщение",type:"text"},null,8,["modelValue"])]),_:1}),a(h,{color:"info",label:"Отправить",onClick:l[7]||(l[7]=e=>de())})]),_:1},8,["modelValue"]),a(y,{modelValue:k.value,"onUpdate:modelValue":l[11]||(l[11]=e=>k.value=e),title:"Редактировать номер телефона пользователя"},{default:n(()=>[a(N,{label:"Номер телефона"},{default:n(()=>[a(C,{modelValue:S.value,"onUpdate:modelValue":l[9]||(l[9]=e=>S.value=e),placeholder:"Номер",type:"number",masked:!0,mask:"7##########"},null,8,["modelValue"])]),_:1}),a(h,{color:"info",label:"Отправить",onClick:l[10]||(l[10]=e=>re())})]),_:1},8,["modelValue"]),a(y,{modelValue:L.value,"onUpdate:modelValue":l[14]||(l[14]=e=>L.value=e),title:"Добавить пользователей в группу"},{default:n(()=>[a(N,{label:"Группа",help:"Выберите группу"},{default:n(()=>[a(C,{modelValue:s.value,"onUpdate:modelValue":l[12]||(l[12]=e=>s.value=e),type:"select",options:j.value.map(e=>({value:e.id,label:e.name}))},null,8,["modelValue","options"])]),_:1}),a(h,{color:"info",label:"Отправить",onClick:l[13]||(l[13]=e=>Z())})]),_:1},8,["modelValue"]),a(y,{modelValue:K.value,"onUpdate:modelValue":l[15]||(l[15]=e=>K.value=e),title:"Сообщения пользователя","has-table":""},{default:n(()=>[a(ie,{"is-active":K.value},null,8,["is-active"])]),_:1},8,["modelValue"]),m.value.length?(u(),i("div",Ne,[t("div",Ie,[(u(!0),i(x,null,M(m.value,e=>(u(),i("div",{key:e.id,class:"flex flex-row justify-start items-center bg-gray-100 dark:bg-slate-700 px-2 py-1 rounded-sm mr-2"},[t("span",Oe,d(e.phone),1),t("div",ze,[a(v,{path:z(he),size:"14",onClick:I=>c(!1,e)},null,8,["path","onClick"])])]))),128))]),a(h,{label:"Добавить в группу",color:"info",small:"",onClick:l[16]||(l[16]=e=>L.value=!0)})])):W("",!0),t("table",null,[t("thead",null,[t("tr",null,[U.checkable?(u(),i("th",Ee)):W("",!0),He,qe,Qe,Je])]),t("tbody",null,[(u(!0),i(x,null,M(V.value,e=>(u(),i("tr",{key:e.id},[U.checkable?(u(),Y(be,{key:0,onChecked:I=>c(I,e)},null,8,["onChecked"])):W("",!0),t("td",Ke,d(e.phone),1),t("td",We,d(e.address),1),t("td",Xe,d(e.city),1),t("td",Ye,[a(h,{color:"success",label:"Отправить",onClick:I=>{S.value=e.phone,F.value=!0}},null,8,["onClick"])])]))),128))])]),t("div",Ze,[a(oe,null,{default:n(()=>[a(ne,null,{default:n(()=>[(u(!0),i(x,null,M(H.value,e=>(u(),Y(h,{key:e,active:e===g.value,label:e+1,small:"",outline:z(E).darkMode,onClick:I=>g.value=e},null,8,["active","label","outline","onClick"]))),128))]),_:1}),t("small",null,"Страница "+d(T.value)+" из "+d(A.value),1)]),_:1})])],64)}}};export{ul as _};
