import{s as D,x as U,y as j,f as V,z as v,j as c,o as n,c as o,b as l,w as i,F as b,A as C,t as p,B as x,a,C as M,k as A,q,i as z,_ as H,D as I,E as O}from"./DSqohS_p.js";import{_ as Q}from"./Cu6ajlfn.js";import{_ as G}from"./BHYj_u1D.js";import{_ as J}from"./T45vWLzi.js";import{_ as P}from"./byDhHAzm.js";import{a as m,_ as K}from"./DTQ49aZk.js";import{_ as R}from"./C2qxqNzf.js";import{_ as W}from"./B8F8NKH2.js";import"./DYukAyPS.js";import"./BZ2oriIC.js";import"./C3z8ikX4.js";const X=a("p",null,"Данное действие необратимо.",-1),Y={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800"},Z={key:0},ee=a("th",null,"Имя, Фамилия",-1),te=a("th",null,"Телефон",-1),ae=a("th",null,"Редактировать",-1),le=a("th",null,"Удалить",-1),ne={"data-label":"Имя, Фамилия"},se={"data-label":"Телефон"},oe={"data-label":"Редактировать"},ie={"data-label":"Удалить"},re={class:"p-3 lg:px-6 border-t border-gray-100 dark:border-slate-800"},ue={__name:"TableSampleAdmins",props:{checkable:Boolean},setup(g){const k=D(U,{sameSite:"None",secure:!0}),y=j(),r=V(),S=v(()=>r.isSearchingAdmins?r.adminsFound:r.admins),_=c(0);c(!1),c(!1);const u=c(!1),$=c(10),f=c(0),h=c([]),L=v(()=>S.value.slice($.value*f.value,$.value*(f.value+1))),B=v(()=>Math.ceil(S.value.length/$.value)),N=v(()=>f.value+1),w=v(()=>{const s=[];for(let t=0;t<B.value;t++)s.push(t);return s}),T=(s,t)=>{const e=[];return s.forEach(d=>{t(d)||e.push(d)}),e},E=(s,t)=>{s?h.value.push(t):h.value=T(h.value,e=>e.id===t.id)},F=async()=>{const s=q+"remove-admin";await $fetch(s,{method:"POST",body:{id:_.value,token:k.value}}).then(t=>{t.message==="ok"&&(u.value=!1,r.getAdminsList())})};return(s,t)=>(n(),o(b,null,[l(Q,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=e=>u.value=e),title:"Удаление администратора"},{default:i(()=>[X,l(P,null,{default:i(()=>[l(m,{color:"danger",onClick:t[0]||(t[0]=e=>F()),label:"Удалить"}),l(m,{color:"info",outline:"",onClick:t[1]||(t[1]=e=>{_.value=0,u.value=!1}),label:"Отмена"})]),_:1})]),_:1},8,["modelValue"]),h.value.length?(n(),o("div",Y,[(n(!0),o(b,null,C(h.value,e=>(n(),o("span",{key:e.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-slate-700"},p(e.name),1))),128))])):x("",!0),a("table",null,[a("thead",null,[a("tr",null,[g.checkable?(n(),o("th",Z)):x("",!0),ee,te,ae,le])]),a("tbody",null,[(n(!0),o(b,null,C(L.value,e=>(n(),o("tr",{key:e.id},[g.checkable?(n(),M(G,{key:0,onChecked:d=>E(d,e)},null,8,["onChecked"])):x("",!0),a("td",ne,p(e.fio.length>0?e.fio:"---"),1),a("td",se,p(e.phone.length>0?e.phone:"---"),1),a("td",oe,[l(m,{color:"info",label:"Редактировать",to:`/admins/edit/${e.id}`},null,8,["to"])]),a("td",ie,[l(m,{color:"info",label:"Удалить",onClick:d=>{_.value=e.id,u.value=!0}},null,8,["onClick"])])]))),128))])]),a("div",re,[l(J,null,{default:i(()=>[l(P,null,{default:i(()=>[(n(!0),o(b,null,C(w.value,e=>(n(),M(m,{key:e,active:e===f.value,label:e+1,small:"",outline:A(y).darkMode,onClick:d=>f.value=e},null,8,["active","label","outline","onClick"]))),128))]),_:1}),a("small",null,"Страница "+p(N.value)+" из "+p(B.value),1)]),_:1})])],64))}},ye={__name:"index",setup(g){const k=V();z(()=>{k.getAdminsList()});const y=r=>{k.setSearchingAdminsQuery(r)};return(r,S)=>{const _=ue,u=H;return n(),o("div",null,[l(u,{name:"authenticated"},{default:i(()=>[l(R,null,{default:i(()=>[l(W,{icon:A(I),title:"Администраторы",main:""},{default:i(()=>[l(m,{color:"success",label:"Добавить",to:"/admins/new"})]),_:1},8,["icon"]),l(K,{icon:A(O),title:" ","has-table":"","has-searchbar":"",onSearchString:y},{default:i(()=>[l(_,{checkable:!1})]),_:1},8,["icon"])]),_:1})]),_:1})])}}};export{ye as default};
