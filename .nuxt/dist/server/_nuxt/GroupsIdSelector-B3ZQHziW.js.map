{"version":3,"file":"GroupsIdSelector-B3ZQHziW.js","sources":["../../../../components/GroupsIdSelector.vue"],"sourcesContent":["<script setup>\nimport { ref, computed, defineEmits, watch, onMounted, defineProps, onUnmounted } from \"vue\";\nimport { useMainStore } from \"~~/stores/main\";\nimport { mdiClose } from \"@mdi/js\";\n\nconst mainStore = useMainStore();\n\nconst emit = defineEmits();\n\nconst isDropdownOpen = ref(false);\nconst selectedGroups = ref([]);\nconst allGroup = { id: 0, name: \"Все пользователи\" };\n\nconst props = defineProps({\n  preSelectedGroups: {\n    type: Array,\n    default: [],\n  }\n});\n\nonMounted( async () => {\n  await mainStore.getGroupsList()\n  if(props.preSelectedGroups.length > 0){\n    for(let i = 0; i < props.preSelectedGroups.length; i++){\n      let group = mainStore.filteredGroups.find((g) => g.id == props.preSelectedGroups[i])\n      selectGroup(group)\n    }\n  }\n})\n\nconst selectGroup = (group) => {\n  selectedGroups.value.push(group);\n  isDropdownOpen.value = false;\n  emit(\n    \"update:modelValue\",\n    selectedGroups.value.map((g) => g.id)\n  );\n};\n\nwatch(selectedGroups, () => {\n  if (selectedGroups.value.length === 0) {\n    displayedGroups.value = [allGroup, ...mainStore.filteredGroups];\n  } else {\n    displayedGroups.value = mainStore.filteredGroups;\n  }\n});\n\nwatch(() => props.preSelectedGroups, (newValue) => {\n  selectedGroups.value = [];\n  if (newValue.length > 0) {\n    for (let i = 0; i < newValue.length; i++) {\n      let group = mainStore.filteredGroups.find((g) => g.id == newValue[i]);\n      selectGroup(group);\n    }\n  }\n});\n\nconst filteredGroups = computed({\n  get: () => {\n    return selectedGroups.value.length === 0\n      ? mainStore.filteredGroups\n      : mainStore.filteredGroups.filter(\n          (group) => !selectedGroups.value.some((g) => g.id === group.id)\n        );\n  },\n  set: (newValue) => {\n    console.log(newValue);\n  },\n});\n\nconst displayedGroups = computed({\n  get: () => {\n    return selectedGroups.value.length === 0 ? [allGroup] : selectedGroups.value;\n  }, \n  set: (newValue) => {\n    console.log(newValue)\n  }\n});\n\nwatch(selectedGroups, () => {\n  if (selectedGroups.value.length === 0) {\n    displayedGroups.value = [allGroup, ...mainStore.filteredGroups];\n  } else {\n    displayedGroups.value = mainStore.filteredGroups;\n  }\n});\n\nconst removeGroup = (group) => {\n  selectedGroups.value = selectedGroups.value.filter((g) => g.id !== group.id);\n  emit(\n    \"update:modelValue\",\n    selectedGroups.value.map((g) => g.id)\n  );\n};\n\nconst showDropdown = () => {\n  isDropdownOpen.value = true;\n};\n\nonUnmounted(() => {\n  selectedGroups.value = [];\n})\n</script>\n\n<template>\n  <div>\n    <div\n      class=\"flex flex-row justify-between items-center max-w-full border-gray-700 border rounded w-full bg-white dark:bg-slate-800\"\n    >\n      <div\n        class=\"p-3 bg-gray-100/50 dark:bg-slate-800 flex flex-row justify-between items-center overflow-x-auto\"\n      >\n        <div class=\"flex flex-row justify-start items-center\">\n          <div\n            v-for=\"group in displayedGroups\"\n            :key=\"group.id\"\n            class=\"flex flex-row justify-start items-center bg-gray-200 dark:bg-slate-700 px-2 py-1 rounded-md mr-2\"\n          >\n            <span class=\"text-sm\">\n              {{ group.name }}\n            </span>\n            <div\n              class=\"flex flex-col items-center justify-center p-1 text-slate-800 dark:text-slate-200\"\n            >\n              <BaseIcon\n                :path=\"mdiClose\"\n                size=\"14\"\n                @click=\"removeGroup(group)\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"flex flex-col items-center py-2 px-2\">\n        <button @click.prevent=\"showDropdown\">\n          <svg\n            class=\"w-5 h-5\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n              stroke-width=\"2\"\n              d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"\n            />\n          </svg>\n        </button>\n      </div>\n    </div>\n    <div v-if=\"isDropdownOpen\" class=\"bg-white dark:bg-slate-200 text-slate-800 dark:text-slate-800 border w-full rounded\">\n      <div v-if=\"filteredGroups.length === 0\" class=\"my-2 px-5\">\n        Все группы добавлены\n      </div>\n      <div\n        v-for=\"group in filteredGroups\"\n        :key=\"group.id\"\n        @click=\"selectGroup(group)\"\n        class=\"my-2 px-5\"\n      >\n        {{ group.name }}\n      </div>\n    </div>\n  </div>\n</template>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAKA,UAAM,YAAY,aAAY;AAE9B,UAAM,OAAO;AAEb,UAAM,iBAAiB,IAAI,KAAK;AAChC,UAAM,iBAAiB,IAAI,CAAA,CAAE;AAC7B,UAAM,WAAW,EAAE,IAAI,GAAG,MAAM,mBAAkB;AAElD,UAAM,QAAQ;AAiBd,UAAM,cAAc,CAAC,UAAU;AAC7B,qBAAe,MAAM,KAAK,KAAK;AAC/B,qBAAe,QAAQ;AACvB;AAAA,QACE;AAAA,QACA,eAAe,MAAM,IAAI,CAAC,MAAM,EAAE,EAAE;AAAA,MACxC;AAAA,IACA;AAEA,UAAM,gBAAgB,MAAM;AAC1B,UAAI,eAAe,MAAM,WAAW,GAAG;AACrC,wBAAgB,QAAQ,CAAC,UAAU,GAAG,UAAU,cAAc;AAAA,MAClE,OAAS;AACL,wBAAgB,QAAQ,UAAU;AAAA,MACnC;AAAA,IACH,CAAC;AAED,UAAM,MAAM,MAAM,mBAAmB,CAAC,aAAa;AACjD,qBAAe,QAAQ;AACvB,UAAI,SAAS,SAAS,GAAG;AACvB,iBAAS,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;AACxC,cAAI,QAAQ,UAAU,eAAe,KAAK,CAAC,MAAM,EAAE,MAAM,SAAS,CAAC,CAAC;AACpE,sBAAY,KAAK;AAAA,QAClB;AAAA,MACF;AAAA,IACH,CAAC;AAED,UAAM,iBAAiB,SAAS;AAAA,MAC9B,KAAK,MAAM;AACT,eAAO,eAAe,MAAM,WAAW,IACnC,UAAU,iBACV,UAAU,eAAe;AAAA,UACvB,CAAC,UAAU,CAAC,eAAe,MAAM,KAAK,CAAC,MAAM,EAAE,OAAO,MAAM,EAAE;AAAA,QACxE;AAAA,MACG;AAAA,MACD,KAAK,CAAC,aAAa;AACjB,gBAAQ,IAAI,QAAQ;AAAA,MACrB;AAAA,IACH,CAAC;AAED,UAAM,kBAAkB,SAAS;AAAA,MAC/B,KAAK,MAAM;AACT,eAAO,eAAe,MAAM,WAAW,IAAI,CAAC,QAAQ,IAAI,eAAe;AAAA,MACxE;AAAA,MACD,KAAK,CAAC,aAAa;AACjB,gBAAQ,IAAI,QAAQ;AAAA,MACrB;AAAA,IACH,CAAC;AAED,UAAM,gBAAgB,MAAM;AAC1B,UAAI,eAAe,MAAM,WAAW,GAAG;AACrC,wBAAgB,QAAQ,CAAC,UAAU,GAAG,UAAU,cAAc;AAAA,MAClE,OAAS;AACL,wBAAgB,QAAQ,UAAU;AAAA,MACnC;AAAA,IACH,CAAC;AAED,UAAM,cAAc,CAAC,UAAU;AAC7B,qBAAe,QAAQ,eAAe,MAAM,OAAO,CAAC,MAAM,EAAE,OAAO,MAAM,EAAE;AAC3E;AAAA,QACE;AAAA,QACA,eAAe,MAAM,IAAI,CAAC,MAAM,EAAE,EAAE;AAAA,MACxC;AAAA,IACA;AAMA,gBAAY,MAAM;AAChB,qBAAe,QAAQ;IACzB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}