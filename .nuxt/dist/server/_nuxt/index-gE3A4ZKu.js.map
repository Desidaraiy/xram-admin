{"version":3,"file":"index-gE3A4ZKu.js","sources":["../../../../pages/advertising/index.vue"],"sourcesContent":["<script setup>\nimport { computed, onMounted } from 'vue'\nimport { useMainStore } from '@/stores/main'\nimport {\n  mdiStar\n} from '@mdi/js'\n\nimport SectionMain from '@/components/SectionMain.vue'\nimport { proxyBaseUrl } from '~~/configs/fetchBaseUrl';\n\nconst mainStore = useMainStore()\n\nonMounted(() => {\n  mainStore.getAdvertsList()\n})\nconst adverts = computed(() => mainStore.adverts)\nfunction checkPictureUrl(url){\n  return url.match(/\\.(jpeg|jpg|gif|png)$/) != null ? true : false\n}\n\nfunction dateTimeToDate(dateTime){\n  return dateTime.split(' ')[0]\n}\n\n\nconst deleteById = async (id) => {\n\n  const path = proxyBaseUrl+\"remove-advertising\"\n\n  $fetch(path, {\n    method: \"POST\",\n    body: {\n      token: mainStore.userToken,\n      advertising_id: id\n    },\n  }).then((r) => {\n    if (r.message === \"ok\") {\n      mainStore.getAdvertsList();\n    } else {\n      alert(\"Ошибка: \", r);\n    }\n  });\n\n}\n\n</script>\n\n<template>\n  <div>\n    <NuxtLayout name=\"authenticated\">\n      <SectionMain>\n\n      <SectionTitleLineWithButton\n        :icon=\"mdiStar\"\n        title=\"Управление рекламой\"\n        main\n      >\n        <BaseButton\n          color=\"info\"\n          label=\"Добавить рекламу\"\n          to=\"advertising/new\"\n        />\n      </SectionTitleLineWithButton>\n\n      <div v-if=\"adverts.length > 0\" class=\"grid grid-cols-1 gap-6 lg:grid-cols-3 mb-6\">\n        <CardBox\n          v-for=\"advert in adverts\"\n          :key=\"advert.advertising_id\">\n            <img\n              :src=\"checkPictureUrl(advert.picture) ? \n                      advert.picture : \n                      'https://via.placeholder.com/1080x1920?text=Нет изображения'\" \n              class=\"h-64 w-full object-cover\" \n              :alt=\"advert.id\">\n            <h2 class=\"text-xl text-gray-700 dark:text-gray-300 my-2\"> {{ advert.title }}</h2>\n            <p> {{ advert.text.length < 0 ? 'Текст объявления пуст' : advert.text }}</p>\n            <p>Дата старта: {{ dateTimeToDate(advert.date_start) }}</p>\n            <p>Дата окончания: {{ dateTimeToDate(advert.date_end) }}</p>\n            <div class=\"flex flex-row justify-between my-5 items-center\">\n              <p>Миниатюра:</p>\n              <img \n                :src=\"checkPictureUrl(advert.preview) ? \n                advert.preview : \n                'https://via.placeholder.com/500x500?text=Нет миниатюры'\" \n                class=\"rounded-md h-24 w-24 object-cover\" \n                :alt=\"advert.advertising_id\">\n            </div>\n            <BaseButtons>\n              <BaseButton label=\"Удалить\" color=\"warning\" small outline @click=\"deleteById(advert.advertising_id)\" />\n              <BaseButton label=\"Редактировать\" color=\"info\" small outline :to=\"`/advertising/edit/${advert.advertising_id}`\" />\n            </BaseButtons>\n        </CardBox>\n      </div>\n      <div v-else class=\"flex flex-col h-192 items-center justify-center\">\n        <h2 class=\"text-xl text-gray-700 dark:text-gray-300 my-2\">Нет объявлений</h2>\n      </div>\n    </SectionMain>\n    </NuxtLayout>\n  </div>\n\n</template>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,UAAM,YAAY,aAAc;AAKhC,UAAM,UAAU,SAAS,MAAM,UAAU,OAAO;AAChD,aAAS,gBAAgB,KAAI;AAC3B,aAAO,IAAI,MAAM,uBAAuB,KAAK,OAAO,OAAO;AAAA,IAC7D;AAEA,aAAS,eAAe,UAAS;AAC/B,aAAO,SAAS,MAAM,GAAG,EAAE,CAAC;AAAA,IAC9B;AAGA,UAAM,aAAa,OAAO,OAAO;AAE/B,YAAM,OAAO,eAAa;AAE1B,aAAO,MAAM;AAAA,QACX,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,OAAO,UAAU;AAAA,UACjB,gBAAgB;AAAA,QACjB;AAAA,MACL,CAAG,EAAE,KAAK,CAAC,MAAM;AACb,YAAI,EAAE,YAAY,MAAM;AACtB,oBAAU,eAAc;AAAA,QAC9B,OAAW;AACL,gBAAM,YAAY,CAAC;AAAA,QACpB;AAAA,MACL,CAAG;AAAA,IAEH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}